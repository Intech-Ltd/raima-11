<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:tocPath="SQL API|RSQL User's Guide|RSQL API Function Reference" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" lang="en-us" xml:lang="en-us" MadCap:PathToHelpSystem="../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>rsqlBindNamedParam</title>
        <link rel="icon" type="image/png" href="http://docs.raima.com/favicon.png" />
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/FunctionArgs.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/SQLErrorCodes.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/raima.css" rel="stylesheet" />
        <script src="../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop" style="display: none;"><a href="../../Default_CSH.htm#SQLRM/rsqlBindNamedParam.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../dbRSQL.htm">SQL API</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../RSQLUG/dbSQLUG.htm">RSQL User's Guide</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="SQLAPIReference.htm">RSQL API Function Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">rsqlBindNamedParam</span>
        </div>
        <h3 class="newpage"><a name="kanchor265"></a>rsqlBindNamedParam</h3>
        <p>Bind a data value to a named parameter marker</p>
        <p class="Heading">Prototype</p><pre xml:space="preserve">RSQL_ERRCODE EXTERNAL_FCN rsqlBindNamedParam(
    HSTMT              hStmt,      
    const char        *name,      
    SQL_T              type,       
    const void        *value,      
    const int32_t     *pLenValue,
    uint16_t          *pParno)</pre>
        <p class="Heading">Arguments</p>
        <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/FunctionArgs.css');caption-side: top;margin-left: 0;margin-right: auto;" class="TableStyle-FunctionArgs" cellspacing="0">
            <col class="Column-Column1" />
            <col class="Column-Column3" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">hStmt      </td>
                    <td class="BodyE-Column3-Body1">(input)</td>
                    <td class="BodyD-Column2-Body1">Statement handle.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">name</td>
                    <td class="BodyE-Column3-Body1">(input)</td>
                    <td class="BodyD-Column2-Body1">The name of the parameter</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">type</td>
                    <td class="BodyE-Column3-Body1">(input)</td>
                    <td class="BodyD-Column2-Body1">The data type of the parameter value. (See <a href="SQLAPIReference.htm#SQL_T">SQL_T&#160;Data Type</a> table)</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">value</td>
                    <td class="BodyE-Column3-Body1">(input)</td>
                    <td class="BodyD-Column2-Body1">Pointer to the variable containing the value.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">pLenValue</td>
                    <td class="BodyE-Column3-Body1">(input)</td>
                    <td class="BodyD-Column2-Body1">Pointer to  variable that contains the length of the parameter value (can be NULL).</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">pParno</td>
                    <td class="BodyB-Column3-Body1">(output)</td>
                    <td class="BodyA-Column2-Body1">Number of the parameter marker associated with name: <code>1 &lt;= parno &lt;=  #</code> of parameters (can be NULL).</td>
                </tr>
            </tbody>
        </table>
        <p class="Heading">Description</p>
        <p>Function <code>rsqlBindNamedParam</code> is used to associate a host program variable location with a named parameter that was specified in the SQL statement associated with statement handle <code>hStmt</code>.   The associated SQL statement must already have been compiled (through a prior call to <code>rsqlPrepare</code>) and a named parameter must have been specified in a SQL statement string using  ":<i>parname</i>".</p>
        <p>The data type specified by type must be compatible with the use of the parameter in the statement but the type check may not occur until the statement is executed (<code>rsqlExecute</code>).   So, <code>errPARMTYPE</code> can be returned by <code>rsqlBindNamedParam</code> to indicate an invalid parameter value data type, however, the same error code may not be returned until the call to <code>rsqlExecute</code>.</p>
        <p>The name of the parameter (not including the ":" symbol) is specified by the name string argument.</p>
        <p>The <code>vallen</code> argument is a pointer to an <code>int32_t</code> variable that is used to specify the length of any non-null-terminated variable length parameter types (e.g., <code>tBINARY</code>).    It is also used to specify a null parameter value (<code>*pLenvalue = -1</code>) and to specify a data-at-exec parameter (<code>*pLenValue = -2</code>).</p>
        <p>For data-at-exec parameters the value pointer argument is not used to point to the parameter value itself (this is done through calls to <code>rsqlPutData</code>) but will be returned to the application when function <code>rsqlParamData</code> is called to begin processing of the data-at-exec parameter,</p>
        <p class="Notes">Note that data-at-exec parameters can only be specified for blob data types.</p>
        <p>If the <code>pParno</code> argument is not <code>NULL</code>, the parameter number of the named parameter will be returned to the <code>uint16_t</code> variable pointed to by <code>pParno</code>.   You can call <code>rsqlBindNamedParam</code> with both value and <code>pLenValue</code> as <code>NULL</code> in order to get the parameter number which can then be used in a call to <code>rsqlGetParamDescr</code>.</p>
        <p class="Heading">Example</p><pre xml:space="preserve">#include "rsql.h"
&#160;&#160;&#160;&#160;...
HSTMT hstmt;
RSQL_ERRCODE stat;
uint16_t nopars, nocols;
RSQL_VALUE *row;
char        bio_search[50] = "%American%";

&#160;&#160;&#160;&#160;...
    stat = rsqlPrepare(hstmt, "select * from author where short_bio like :biostr");
    if ( stat == errSUCCESS ) {
        <b>stat = rsqlBindNamedParam(hstmt, "biostr", tSMALLINT, &amp;bio_search, NULL, NULL);</b>
        if ( stat == errSUCCESS ) {
            stat = rsqlExecute(hstmt);
            while ( stat == errSUCCESS )
                stat = rsqlFetch(hstmt, &amp;row);
        }
    }
&#160;&#160;&#160;&#160;...</pre>
        <p class="Heading">Required Headers</p><pre xml:space="preserve">#include "rsql.h"</pre>
        <p class="Heading">Libraries</p>
        <table style="width: 100%; margin-left: 0; margin-right: auto;">
            <col style="width: 200px;">
            </col>
            <col>
            </col>
            <thead>
                <tr>
                    <th>Library Name</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>rdmrsql<span class="MyVariablesLibraryVersion">11</span></code>
                    </td>
                    <td>RSQL&#160;API Library</td>
                </tr>
            </tbody>
        </table>
        <p>See <a href="../GS/distrib.htm#Library">Library Naming Conventions</a> section for full library name and a list of library dependencies.</p>
        <p class="Heading">Return Codes</p>
        <table class="TableStyle-SQLErrorCodes" cellspacing="0" style="mc-table-style: url('../Resources/TableStyles/SQLErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <col class="Column-Column4" />
            <tbody>
                <tr class="Body-Body1">
                    <th class="BodyB-Column1-Body1" style="font-weight: bold;">Error Code</th>
                    <th class="BodyB-Column2-Body1" style="font-weight: bold;">Enum Identifier</th>
                    <th class="BodyB-Column3-Body1" style="font-weight: bold;">SQL State</th>
                    <th class="BodyA-Column4-Body1" style="font-weight: bold;">Description</th>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-SQLErrorCodes" cellspacing="0" style="mc-table-style: url('../Resources/TableStyles/SQLErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <col class="Column-Column4" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">0</td>
                    <td class="BodyB-Column2-Body1">errSUCCESS</td>
                    <td class="BodyB-Column3-Body1">00000</td>
                    <td class="BodyA-Column4-Body1">no error was detected</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-SQLErrorCodes" cellspacing="0" style="mc-table-style: url('../Resources/TableStyles/SQLErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <col class="Column-Column4" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">-5</td>
                    <td class="BodyB-Column2-Body1">errINVHANDLE</td>
                    <td class="BodyB-Column3-Body1">02002</td>
                    <td class="BodyA-Column4-Body1">invalid connection or statement handle</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-SQLErrorCodes" cellspacing="0" style="mc-table-style: url('../Resources/TableStyles/SQLErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <col class="Column-Column4" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">18</td>
                    <td class="BodyB-Column2-Body1">errNOMEMORY</td>
                    <td class="BodyB-Column3-Body1">HY013</td>
                    <td class="BodyA-Column4-Body1">memory management error</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-SQLErrorCodes" cellspacing="0" style="mc-table-style: url('../Resources/TableStyles/SQLErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <col class="Column-Column4" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">28</td>
                    <td class="BodyB-Column2-Body1">errINVARG</td>
                    <td class="BodyB-Column3-Body1">HY009</td>
                    <td class="BodyA-Column4-Body1">invalid argument value</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-SQLErrorCodes" cellspacing="0" style="mc-table-style: url('../Resources/TableStyles/SQLErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <col class="Column-Column4" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">29</td>
                    <td class="BodyB-Column2-Body1">errINVNULL</td>
                    <td class="BodyB-Column3-Body1">HY009</td>
                    <td class="BodyA-Column4-Body1">invalid use of null pointer</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-SQLErrorCodes" cellspacing="0" style="mc-table-style: url('../Resources/TableStyles/SQLErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <col class="Column-Column4" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">65</td>
                    <td class="BodyB-Column2-Body1">errINVSTATE</td>
                    <td class="BodyB-Column3-Body1">RX008</td>
                    <td class="BodyA-Column4-Body1">invalid statement state</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-SQLErrorCodes" cellspacing="0" style="mc-table-style: url('../Resources/TableStyles/SQLErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <col class="Column-Column4" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">117</td>
                    <td class="BodyB-Column2-Body1">errPARMTYPE</td>
                    <td class="BodyB-Column3-Body1">HY105</td>
                    <td class="BodyA-Column4-Body1">invalid parameter type</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-SQLErrorCodes" cellspacing="0" style="mc-table-style: url('../Resources/TableStyles/SQLErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <col class="Column-Column4" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">142</td>
                    <td class="BodyB-Column2-Body1">errDATAATEXEC</td>
                    <td class="BodyB-Column3-Body1">RX021</td>
                    <td class="BodyA-Column4-Body1">data-at-exec params only allowed with INSERT VALUES/UPDATE</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-SQLErrorCodes" cellspacing="0" style="mc-table-style: url('../Resources/TableStyles/SQLErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <col class="Column-Column4" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">143</td>
                    <td class="BodyB-Column2-Body1">errBLOBPARSONLY</td>
                    <td class="BodyB-Column3-Body1">RX022</td>
                    <td class="BodyA-Column4-Body1">data-at-exec params only allowed for blob (long var...) columns</td>
                </tr>
            </tbody>
        </table>
        <p class="Heading">See Also</p>
        <p><a href="rsqlBindParam.htm">rsqlBindParam</a>
        </p>
        <p><a href="rsqlParamData.htm">rsqlParamData</a>
        </p>
        <p><a href="rsqlPutData.htm">rsqlPutData</a>
        </p>
        <hr MadCap:conditions="Default.ScreenOnly" width="100%" size="0" align="center" />
        <p MadCap:conditions="Default.ScreenOnly" style="font-size: 8pt;"><span class="MyVariablesCopyright">Copyright © 2012, Raima Inc. All rights reserved.</span>
        </p>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom" style="display: none;"><a href="../../Default_CSH.htm#SQLRM/rsqlBindNamedParam.htm" style="">Open topic with navigation</a>
        </p>
    </body>
</html>