<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:tocPath="SQL API|ODBC User's Guide|ODBC API&#160;Reference" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" lang="en-us" xml:lang="en-us" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>SQLExtendedTran</title>
        <link rel="icon" type="image/png" href="http://docs.raima.com/favicon.png" />
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/TwoColNoLines.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/ODBCStateTable.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/FunctionArgs.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/ODBCErrorCodes.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/raima.css" rel="stylesheet" />
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop" style="display: none;"><a href="../../../Default_CSH.htm#ODBCRM/api/SQLExtendedTran.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../../dbRSQL.htm">SQL API</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../dbODBCUG.htm">ODBC User's Guide</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../ODBCCore.htm">ODBC API&#160;Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">SQLExtendedTran</span>
        </div>
        <h3 class="newpage"><a name="kanchor360"></a>SQLExtendedTran</h3>
        <p>Performs a transaction operation</p>
        <p class="Heading">Conformance</p>
        <p>Version Introduced: <span class="MyVariablesProductShortName">RDM</span> ODBC&#160;API&#160;extension</p>
        <p class="Heading">Syntax </p><pre>SQLRETURN SQL_API SQLExtendedTran(
    SQLSMALLINT      HandleType,
    SQLHANDLE        Handle,
    SQLSMALLINT      TransType,
    SQLSMALLINT      ReadOnly,
    const SQLCHAR   *TransactionID,
    SQLSMALLINT      StringLengthPtr)
</pre>
        <p class="Heading">Arguments</p>
        <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/FunctionArgs.css');margin-left: 0;margin-right: auto;" class="TableStyle-FunctionArgs" cellspacing="0">
            <col style="width: 140px;" class="Column-Column1">
            </col>
            <col style="width: 80px;" class="Column-Column3">
            </col>
            <col class="Column-Column2">
            </col>
            <tbody>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">HandleType</td>
                    <td style="" class="BodyE-Column3-Body1">(input)</td>
                    <td style="" class="BodyD-Column2-Body1">Handle type identifier. Contains either SQL_HANDLE_ENV (if Handle is an environment handle) or SQL_HANDLE_DBC (if Handle is a connection handle).</td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">Handle</td>
                    <td style="" class="BodyE-Column3-Body1">(input)</td>
                    <td style="" class="BodyD-Column2-Body1">The handle, of the type indicated by <code>HandleType</code>, indicating the scope of the transaction.</td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">OperationType</td>
                    <td style="" class="BodyE-Column3-Body1">(input)</td>
                    <td style="" class="BodyD-Column2-Body1">One of the following operation types:<ul><li style="font-size: 10pt;" value="1">SQL_START		-Start a transaction</li><li style="font-size: 10pt;" value="2">SQL_SAVEPOINT	-Create a save point in a transaction</li><li style="font-size: 10pt;" value="3">SQL_RELEASE	Release a save point in a transaction</li><li style="font-size: 10pt;" value="4">SQL_COMMIT	-Commit a transaction</li><li style="font-size: 10pt;" value="5">SQL_ROLLBACK	-Rollback a transaction
</li></ul></td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">ReadOnly</td>
                    <td style="" class="BodyE-Column3-Body1">(input)</td>
                    <td style="" class="BodyD-Column2-Body1">Read-only mode, as follows:<ul><li style="font-size: 10pt;" value="1">SQL_TRUE		Transaction is read-only.</li><li style="font-size: 10pt;" value="2">SQL_FALSE		Transaction is read-write</li></ul><br />If <code>OperationType</code> is not SQL_START or SQL_COMMIT, this parameter is ignored.
</td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">TransactionID</td>
                    <td style="" class="BodyE-Column3-Body1">(input)</td>
                    <td style="" class="BodyD-Column2-Body1">Character string that indicates the unique ID of the transaction operation. If Operation Code is SQL_COMMIT, this parameter is ignored. If <code>TransactionID</code> is not specified with SQL_START, an internal system value will be used. TransactionID is required with SQL_SAVEPOINT and SQL_RELEASE.</td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyB-Column1-Body1">StringLengthPtr</td>
                    <td style="" class="BodyB-Column3-Body1">(input)</td>
                    <td style="" class="BodyA-Column2-Body1">The length of <code>TransactionID</code> in characters. SQL_NTS can be used to indicate that <code>TransactionID</code> is null-terminated.</td>
                </tr>
            </tbody>
        </table>
        <p class="Heading">Required Headers</p><pre xml:space="preserve">#include "sqlrext.h"</pre>
        <p class="Heading">Libraries</p>
        <table style="width: 100%; margin-left: 0; margin-right: auto;">
            <col style="width: 200px;">
            </col>
            <col>
            </col>
            <thead>
                <tr>
                    <th>Library Name</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>rdmrdbc<span class="MyVariablesLibraryVersion">11</span></code>
                    </td>
                    <td><span class="MyVariablesProductShortName">RDM</span> ODBC&#160;API Library</td>
                </tr>
            </tbody>
        </table>
        <p>See <a href="../../GS/distrib.htm#Library">Library Naming Conventions</a> section for full library name and a list of library dependencies.</p>
        <p class="Heading">Returns</p>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <th class="BodyB-Column1-Body1" style="font-weight: bold;">Return Code</th>
                    <th class="BodyA-Column2-Body1" style="font-weight: bold;">Description</th>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_SUCCESS</td>
                    <td class="BodyA-Column2-Body1">Function completed successfully. The application calls <code>SQLGetDiagField</code> to retrieve additional information from the header record.
</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_SUCCESS_WITH_INFO</td>
                    <td class="BodyA-Column2-Body1">Function completed successfully, possibly with a nonfatal error (warning). The application calls <code>SQLGetDiagRec</code> or <code>SQLGetDiagField</code> to retrieve additional information.
</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_ERROR</td>
                    <td class="BodyA-Column2-Body1">Function failed. The application calls <code>SQLGetDiagRec</code> or <code>SQLGetDiagField</code> to retrieve additional information. The contents of any output arguments to the function are undefined.
</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_INVALID_HANDLE</td>
                    <td class="BodyA-Column2-Body1">Function failed due to an invalid environment, connection, statement, or descriptor handle. This indicates a programming error. No additional information is available from <code>SQLGetDiagRec</code> or <code>SQLGetDiagField</code>. This code is returned only when the handle is a null pointer or is the wrong type, such as when a statement handle is passed for an argument that requires a connection handle.
</td>
                </tr>
            </tbody>
        </table>
        <p class="Heading">Diagnostics</p>
        <table style="mc-table-style: url('../../Resources/TableStyles/ODBCStateTable.css');" class="TableStyle-ODBCStateTable" cellspacing="0">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <col class="Column-Column3" />
            <tbody>
                <tr class="Body-Body1">
                    <th class="BodyE-Column1-Body1">SQLSTATE</th>
                    <th class="BodyE-Column2-Body1">Error</th>
                    <th class="BodyD-Column3-Body1">Description</th>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">01000</td>
                    <td class="BodyE-Column2-Body1">General warning</td>
                    <td class="BodyD-Column3-Body1">General error returned from the <span class="MyVariablesProductShortName">RDM</span> ODBC driver. The function returns SQL_SUCCESS_WITH_INFO.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">08003</td>
                    <td class="BodyE-Column2-Body1">Connection not open</td>
                    <td class="BodyD-Column3-Body1">The <span class="MyVariablesProductShortName">RDM</span> ODBC driver is not connected to a data source.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">25000</td>
                    <td class="BodyE-Column2-Body1">Transaction already active</td>
                    <td class="BodyD-Column3-Body1">SQL_START is specified for <code>OperationType</code> and a transaction is already active on the connection associated with <code>Handle</code>.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">25001</td>
                    <td class="BodyE-Column2-Body1">Read-only transaction already active</td>
                    <td class="BodyD-Column3-Body1">SQL_START, SQL_SAVEPOINT or SQL_RELEASE is specified for <code>OperationType</code> and a read-only transaction is active on the connection associated with <code>Handle</code>.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">25S01</td>
                    <td class="BodyE-Column2-Body1">Transaction state unknown</td>
                    <td class="BodyD-Column3-Body1">When <code>HandleType</code> is SQL_HANDLE_ENV and one or more of the connections in Handle failed to complete the transaction.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">HY001</td>
                    <td class="BodyE-Column2-Body1">Memory allocation error</td>
                    <td class="BodyD-Column3-Body1">Either the ODBC driver or the SQL engine failed to allocate sufficient memory to complete the required operation.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">HY010</td>
                    <td class="BodyE-Column2-Body1">Function sequence error</td>
                    <td class="BodyD-Column3-Body1">This function was called after <code>SQLExecute</code> or <code>SQLExecDirect</code> but before all the parameters were bound.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">HY012</td>
                    <td class="BodyE-Column2-Body1">Invalid transaction operation code</td>
                    <td class="BodyD-Column3-Body1">The value in <code>OperationType</code> is not one of the following:<ul><li value="1">SQL_START</li><li value="2">SQL_SAVEPOINT</li><li value="3">SQL_RELEASE</li><li value="4">SQL_COMMIT</li><li value="5">SQL_ROLLBACK</li></ul></td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">HY013</td>
                    <td class="BodyE-Column2-Body1">Memory management error</td>
                    <td class="BodyD-Column3-Body1">The <span class="MyVariablesProductShortName">RDM</span> SQL engine failed to allocate sufficient memory to complete the required operation.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">HY092</td>
                    <td class="BodyB-Column2-Body1">Invalid attribute/option identifier</td>
                    <td class="BodyA-Column3-Body1">The value in <code>HandleType</code> is not one of the following values:<ul><li value="1">SQL_HANDLE_ENV</li><li value="2">SQL_HANDLE_DBC</li></ul></td>
                </tr>
            </tbody>
        </table>
        <p class="Heading">Comments</p>
        <p><code>SQLExtendedTran</code> allows an <span class="MyVariablesProductShortName">RDM</span> ODBC application to start a transaction, create a save point inside the current transaction, and roll back to the last save point, as well as committing and rolling back a transaction.</p>
        <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/TwoColNoLines.css');margin-left: 0;margin-right: auto;" class="TableStyle-TwoColNoLines" cellspacing="0">
            <col class="Column-Column1" style="width: 200px;" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1" style="font-style: italic;">
                        <p><i>Starting a transaction</i>
                        </p>
                    </td>
                    <td class="BodyD-Column2-Body1">
                        <p><code>SQLExtendedTran</code> can be called to start a regular ("read-write") transaction or a "read-only" transaction. The value specified for the <code>ReadOnly</code> parameter determines the type of transaction to start. To start a read-only transaction, specify SQL_TRUE for the <code>ReadOnly</code> parameter.</p>
                        <p>An application can optionally specify the unique ID of the transaction by using the <code>TransactionID</code> parameter. If NULL or an empty string is specified for the <code>TransactionID</code> parameter, an internal system ID will be used</p>
                    </td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">
                        <p><i>Creating a save point</i>
                        </p>
                    </td>
                    <td class="BodyD-Column2-Body1">
                        <p><code>SQLExtendedTran</code> can be used to create a save point in the current read-write transaction. An application must specify a unique ID of the save point using the <code>TransactionID</code> parameter. An application can roll back the database changes that are made after the save point by calling SQLExtendedTran with SQL_ROLLBACK and the ID that matches the one associated with the save point.</p>
                    </td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">
                        <p><i>Releasing a save point</i>
                        </p>
                    </td>
                    <td class="BodyD-Column2-Body1">
                        <p>An application can manually release, or discard, any of the save points it created by calling <code>SQLExtendedTran</code> specifying SQL_RELEASE for <code>OperationType</code> and the ID associated with the save point. A call to <code>SQLEndTran</code> to either commit or abort the current transaction will automatically release all save points. A call to <code>SQLExtendedTran</code> to roll back to a save point will automatically release all the save points created after that save point.</p>
                    </td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">
                        <p><i>Rolling back to a save point</i>
                        </p>
                    </td>
                    <td class="BodyD-Column2-Body1">
                        <p>An application can roll back a transaction to a particular save point by calling <code>SQLExtendedTran</code> specifying SQL_ROLLBACK for <code>OperationType</code> and the ID associated with the save point. All save points created after the specified save point will be released. If the specified ID is not associated with any existing save point, the entire transaction will be aborted.</p>
                    </td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">
                        <p><i>Committing a transaction</i>
                        </p>
                    </td>
                    <td class="BodyD-Column2-Body1">
                        <p>An application can commit all changes in a transaction by calling <code>SQLEndTran</code> or <code>SQLExtendedTran</code> specifying SQL_COMMIT. All save points inside the transaction will be released. If no transaction is active, SQL_SUCCESS will be returned.</p>
                    </td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">
                        <p><i>Aborting a transaction</i>
                        </p>
                    </td>
                    <td class="BodyA-Column2-Body1">
                        <p>An application can abort an entire transaction by calling <code>SQLEndTran</code> or <code>SQLExtendedTran</code> specifying SQL_ROLLBACK. For <code>SQLExtendedTran</code>, specify NULL or the ID of the transaction itself for <code>TransactionID</code>. All save points inside the transaction will be released. If no transaction is active, SQL_SUCCESS will be returned.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <hr MadCap:conditions="Default.ScreenOnly" width="100%" size="0" align="center" />
        <p MadCap:conditions="Default.ScreenOnly" style="font-size: 8pt;"><span class="MyVariablesCopyright">Copyright © 2012, Raima Inc. All rights reserved.</span>
        </p>
        <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
        </script>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom" style="display: none;"><a href="../../../Default_CSH.htm#ODBCRM/api/SQLExtendedTran.htm" style="">Open topic with navigation</a>
        </p>
    </body>
</html>