<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:tocPath="SQL API|ODBC User's Guide|ODBC API&#160;Reference" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" lang="en-us" xml:lang="en-us" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>SQLDescribeCol</title>
        <link rel="icon" type="image/png" href="http://docs.raima.com/favicon.png" />
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/FunctionArgs.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/ODBCErrorCodes.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/raima.css" rel="stylesheet" />
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop" style="display: none;"><a href="../../../Default_CSH.htm#ODBCRM/api/SQLDescribeCol.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../../dbRSQL.htm">SQL API</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../dbODBCUG.htm">ODBC User's Guide</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../ODBCCore.htm">ODBC API&#160;Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">SQLDescribeCol</span>
        </div>
        <h3 class="newpage"><a name="kanchor352"></a>SQLDescribeCol</h3>
        <p>Retrieves the basic result data set for a column </p>
        <p class="Heading">Conformance</p>
        <p>Version Introduced: ODBC 1.0 Standards Compliance: ISO 92</p>
        <p class="Heading">Syntax </p><pre>SQLRETURN SQL_API SQLDescribeCol(
        SQLHSTMT         StatementHandle,
        SQLUSMALLINT     ColumnNumber,
        SQLCHAR         *ColumnName,
        SQLSMALLINT      BufferLength,
        SQLSMALLINT     *NameLengthPtr,
        SQLSMALLINT     *DataTypePtr,
        SQLULEN         *ColumnSizePtr,
        SQLSMALLINT     *DecimalDigitsPtr,
        SQLSMALLINT     *NullablePtr)</pre>
        <p class="Heading">Arguments</p>
        <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/FunctionArgs.css');margin-left: 0;margin-right: auto;" class="TableStyle-FunctionArgs" cellspacing="0">
            <col style="width: 140px;" class="Column-Column1" />
            <col style="width: 80px;" class="Column-Column3" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">StatementHandle     </td>
                    <td style="" class="BodyE-Column3-Body1">(input)</td>
                    <td style="" class="BodyD-Column2-Body1">Statement handle.

</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">ColumnNumber</td>
                    <td class="BodyE-Column3-Body1">(input)</td>
                    <td class="BodyD-Column2-Body1">Column number of result data, ordered sequentially in increasing column order, starting at 1.</td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">ColumnName</td>
                    <td style="" class="BodyE-Column3-Body1">(output)</td>
                    <td style="" class="BodyD-Column2-Body1">Pointer to a null-terminated buffer in which to return the column name. This value is read from the SQL_DESC_NAME field of the IRD. If the column is unnamed or the column name cannot be determined, the driver returns an empty string.<br /><br />If ColumnName is NULL, NameLengthPtr will still return the total number of characters (excluding the null-termination character for character data) available to return in the buffer pointed to by ColumnName.
</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">BufferLength</td>
                    <td class="BodyE-Column3-Body1">(input)</td>
                    <td class="BodyD-Column2-Body1">Length of the *ColumnName buffer, in characters. </td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">NameLengthPtr</td>
                    <td style="" class="BodyE-Column3-Body1">(output)</td>
                    <td style="" class="BodyD-Column2-Body1">Pointer to a buffer in which to return the total number of characters (excluding the null termination) available to return in *ColumnName. If the number of characters available to return is greater than or equal to BufferLength, the column name in *ColumnName is truncated to BufferLength minus the length of a null-termination character.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">DataTypePtr</td>
                    <td class="BodyE-Column3-Body1">(output)</td>
                    <td class="BodyD-Column2-Body1">Pointer to a buffer in which to return the SQL data type of the column. This value is read from the SQL_DESC_CONCISE_TYPE field of the IRD. This will be one of the values in SQL Data Types, or a driver-specific SQL data type. If the data type cannot be determined, the driver returns SQL_UNKNOWN_TYPE.</td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">ColumnSizePtr</td>
                    <td style="" class="BodyE-Column3-Body1">(output)</td>
                    <td style="" class="BodyD-Column2-Body1">Pointer to a buffer in which to return the size (in characters) of the column on the data source. If the column size cannot be determined, the driver returns 0. </td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">DecimalDigitsPtr</td>
                    <td class="BodyE-Column3-Body1">(output)</td>
                    <td class="BodyD-Column2-Body1">Pointer to a buffer in which to return the number of decimal digits of the column on the data source. If the number of decimal digits cannot be determined or is not applicable, the driver returns 0. </td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyB-Column1-Body1">NullablePtr</td>
                    <td style="" class="BodyB-Column3-Body1">(output)</td>
                    <td style="" class="BodyA-Column2-Body1">
                        <p>Pointer to a buffer in which to return a value that indicates whether the column allows NULL values. This value is read from the SQL_DESC_NULLABLE field of the IRD. The value is one of the following:</p>
                        <ul>
                            <li style="font-size: 10pt;" value="1">SQL_NO_NULLS: The column does not allow NULL values.</li>
                            <li style="font-size: 10pt;" value="2">SQL_NULLABLE: The column allows NULL values.</li>
                            <li style="font-size: 10pt;" value="3">SQL_NULLABLE_UNKNOWN: The driver cannot determine if the column allows NULL values.
</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="Heading">Required Headers</p><pre xml:space="preserve">#include "sql.h"</pre>
        <p class="Heading">Libraries</p>
        <table style="width: 100%; margin-left: 0; margin-right: auto;">
            <col style="width: 200px;">
            </col>
            <col>
            </col>
            <thead>
                <tr>
                    <th>Library Name</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>rdmrdbc<span class="MyVariablesLibraryVersion">11</span></code>
                    </td>
                    <td><span class="MyVariablesProductShortName">RDM</span>&#160;ODBC&#160;API Library</td>
                </tr>
            </tbody>
        </table>
        <p>See <a href="../../GS/distrib.htm#Library">Library Naming Conventions</a> section for full library name and a list of library dependencies.</p>
        <p class="Heading">Returns</p>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <th class="BodyB-Column1-Body1" style="font-weight: bold;">Return Code</th>
                    <th class="BodyA-Column2-Body1" style="font-weight: bold;">Description</th>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_SUCCESS</td>
                    <td class="BodyA-Column2-Body1">Function completed successfully. The application calls <code>SQLGetDiagField</code> to retrieve additional information from the header record.
</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_SUCCESS_WITH_INFO</td>
                    <td class="BodyA-Column2-Body1">Function completed successfully, possibly with a nonfatal error (warning). The application calls <code>SQLGetDiagRec</code> or <code>SQLGetDiagField</code> to retrieve additional information.
</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_ERROR</td>
                    <td class="BodyA-Column2-Body1">Function failed. The application calls <code>SQLGetDiagRec</code> or <code>SQLGetDiagField</code> to retrieve additional information. The contents of any output arguments to the function are undefined.
</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_INVALID_HANDLE</td>
                    <td class="BodyA-Column2-Body1">Function failed due to an invalid environment, connection, statement, or descriptor handle. This indicates a programming error. No additional information is available from <code>SQLGetDiagRec</code> or <code>SQLGetDiagField</code>. This code is returned only when the handle is a null pointer or is the wrong type, such as when a statement handle is passed for an argument that requires a connection handle.
</td>
                </tr>
            </tbody>
        </table>
        <p>For more information, reference MSDN&#160;documentation for <a href="http://msdn.microsoft.com/en-us/library/ms716289(v=VS.85).aspx" target="_blank">SQLDescribeCol.</a></p>
        <hr MadCap:conditions="Default.ScreenOnly" width="100%" size="0" align="center" />
        <p MadCap:conditions="Default.ScreenOnly" style="font-size: 8pt;"><span class="MyVariablesCopyright">Copyright © 2012, Raima Inc. All rights reserved.</span>
        </p>
        <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
        </script>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom" style="display: none;"><a href="../../../Default_CSH.htm#ODBCRM/api/SQLDescribeCol.htm" style="">Open topic with navigation</a>
        </p>
    </body>
</html>