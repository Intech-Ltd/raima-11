<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:tocPath="SQL API|ODBC User's Guide|ODBC API&#160;Reference" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" lang="en-us" xml:lang="en-us" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>SQLDriverConnect</title>
        <link rel="icon" type="image/png" href="http://docs.raima.com/favicon.png" />
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/FunctionArgs.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/ODBCErrorCodes.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/raima.css" rel="stylesheet" />
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop" style="display: none;"><a href="../../../Default_CSH.htm#ODBCRM/api/SQLDriverConnect.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../../dbRSQL.htm">SQL API</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../dbODBCUG.htm">ODBC User's Guide</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../ODBCCore.htm">ODBC API&#160;Reference</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">SQLDriverConnect</span>
        </div>
        <h3 class="newpage"><a name="kanchor356"></a>SQLDriverConnect</h3>
        <p>Establishes connections to <span class="MyVariablesProductShortName">RDM</span> databases via <span class="MyVariablesProductShortName">RDM</span> ODBC. Accepts more connection options than <code>SQLConnect</code>.</p>
        <p class="Heading">Conformance</p>
        <p>Version Introduced: ODBC 1.0 Standards Compliance: ISO 92</p>
        <p class="Heading">Syntax </p><pre xml:space="preserve">SQLRETURN SQL_API SQLDriverConnect(
        SQLHDBC          ConnectionHandle,
        SQLHWND          WindowHandle,
        const SQLCHAR   *InConnectionString,
        SQLSMALLINT      StringLength1,
        SQLCHAR         *OutConnectionString,
        SQLSMALLINT      BufferLength,
        SQLSMALLINT     *StringLength2Ptr,
        SQLUSMALLINT     DriverCompletion)</pre>
        <p class="Heading">Arguments</p>
        <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/FunctionArgs.css');margin-left: 0;margin-right: auto;" class="TableStyle-FunctionArgs" cellspacing="0">
            <col style="width: 140px;" class="Column-Column1" />
            <col style="width: 80px;" class="Column-Column3" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">ConnectionHandle     </td>
                    <td style="" class="BodyE-Column3-Body1">(input)</td>
                    <td style="" class="BodyD-Column2-Body1">Connection handle.

</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">WindowHandle</td>
                    <td class="BodyE-Column3-Body1">(input)</td>
                    <td class="BodyD-Column2-Body1">Window handle.</td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">InConnectionString</td>
                    <td style="" class="BodyE-Column3-Body1">(input)</td>
                    <td style="" class="BodyD-Column2-Body1">A full connection string (see the syntax in "Comments"), a partial connection string, or an empty string.

</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">StringLength1</td>
                    <td class="BodyE-Column3-Body1">(input)</td>
                    <td class="BodyD-Column2-Body1">Length of <code>*InConnectionString</code>, in characters if the string is Unicode, or bytes if string is ANSI or DBCS.

</td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">OutConnectionString</td>
                    <td style="" class="BodyE-Column3-Body1">(output)</td>
                    <td style="" class="BodyD-Column2-Body1">Pointer to a buffer for the completed connection string. Upon successful connection to the target data source, this buffer contains the completed connection string. Applications should allocate at least 1,024 characters for this buffer.

</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">BufferLength</td>
                    <td class="BodyE-Column3-Body1">(input)</td>
                    <td class="BodyD-Column2-Body1"> Length of the <code>*OutConnectionString</code> buffer, in characters.

</td>
                </tr>
                <tr class="Body-Body1">
                    <td style="" class="BodyE-Column1-Body1">StringLength2Ptr</td>
                    <td style="" class="BodyE-Column3-Body1">(output)</td>
                    <td style="" class="BodyD-Column2-Body1">Pointer to a buffer in which to return the total number of characters (excluding the null-termination character) available to return in <code>*OutConnectionString</code>. If the number of characters available to return is greater than or equal to BufferLength, the completed connection string in <code>*OutConnectionString</code> is truncated to <code>BufferLength</code> minus the length of a null-termination character.

</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">DriverCompletion</td>
                    <td class="BodyB-Column3-Body1">(input)</td>
                    <td class="BodyA-Column2-Body1">Flag that indicates whether the Driver Manager or driver must prompt for more connection information</td>
                </tr>
            </tbody>
        </table>
        <p class="Heading">Required Headers</p><pre xml:space="preserve">#include "sqlext.h"</pre>
        <p class="Heading">Libraries</p>
        <table style="width: 100%; margin-left: 0; margin-right: auto;">
            <col style="width: 200px;">
            </col>
            <col>
            </col>
            <thead>
                <tr>
                    <th>Library Name</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>rdmrdbc<span class="MyVariablesLibraryVersion">11</span></code>
                    </td>
                    <td><span class="MyVariablesProductShortName">RDM</span> ODBC&#160;API Library</td>
                </tr>
            </tbody>
        </table>
        <p>See <a href="../../GS/distrib.htm#Library">Library Naming Conventions</a> section for full library name and a list of library dependencies.</p>
        <p class="Heading">Returns</p>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <th class="BodyB-Column1-Body1" style="font-weight: bold;">Return Code</th>
                    <th class="BodyA-Column2-Body1" style="font-weight: bold;">Description</th>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_SUCCESS</td>
                    <td class="BodyA-Column2-Body1">Function completed successfully. The application calls <code>SQLGetDiagField</code> to retrieve additional information from the header record.
</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_SUCCESS_WITH_INFO</td>
                    <td class="BodyA-Column2-Body1">Function completed successfully, possibly with a nonfatal error (warning). The application calls <code>SQLGetDiagRec</code> or <code>SQLGetDiagField</code> to retrieve additional information.
</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_ERROR</td>
                    <td class="BodyA-Column2-Body1">Function failed. The application calls <code>SQLGetDiagRec</code> or <code>SQLGetDiagField</code> to retrieve additional information. The contents of any output arguments to the function are undefined.
</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_INVALID_HANDLE</td>
                    <td class="BodyA-Column2-Body1">Function failed due to an invalid environment, connection, statement, or descriptor handle. This indicates a programming error. No additional information is available from <code>SQLGetDiagRec</code> or <code>SQLGetDiagField</code>. This code is returned only when the handle is a null pointer or is the wrong type, such as when a statement handle is passed for an argument that requires a connection handle.
</td>
                </tr>
            </tbody>
        </table>
        <table class="TableStyle-ODBCErrorCodes" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">SQL_NO_DATA</td>
                    <td class="BodyA-Column2-Body1">No more data was available. The application calls <code>SQLGetDiagRec</code> or <code>SQLGetDiagField</code> to retrieve additional information.</td>
                </tr>
            </tbody>
        </table>
        <p class="Heading">Comments</p>
        <p style="font-weight: bold;font-style: italic;">InConnectionString</p>
        <p><span class="MyVariablesProductShortName">RDM</span> accepts the following connection string keywords.</p>
        <table style="mc-table-style: url('../../Resources/TableStyles/ODBCErrorCodes.css');margin-left: 0;margin-right: auto;" class="TableStyle-ODBCErrorCodes" cellspacing="0">
            <col class="Column-Column1" />
            <col class="Column-Column2" />
            <thead>
                <tr class="Head-Header1">
                    <th class="HeadE-Column1-Header1">Keyword</th>
                    <th class="HeadD-Column2-Header1">Attribute Value&#160;Description</th>
                </tr>
            </thead>
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">DSN</td>
                    <td class="BodyD-Column2-Body1">When the application accesses the <span class="MyVariablesProductShortName">RDM</span> ODBC Driver through Microsoft ODBC Driver Manager (DM), this is the name of an ODBC data source that points to <span class="MyVariablesProductShortName">RDM</span>. The value of this keyword is ignored if the application is linked directly with the <span class="MyVariablesProductShortName">RDM</span> ODBC Driver.</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">PORT</td>
                    <td class="BodyD-Column2-Body1">TCP/IP port number the TFServer is listening on.  If PORT is not specified, <span class="MyVariablesProductShortName">RDM</span> will use the default value (<span class="MyVariablesDefaultPort">21553</span>).</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">TFS<sup>[1]</sup></td>
                    <td class="BodyD-Column2-Body1">Name of the TFServer. This keyword should be specified instead of DSN when an application attempts to specify our driver with the DRIVER keyword through the Microsoft ODBC DM, in which case the DM will remove the DSN keyword from the connection string.<p>If TFS is specified, <span class="MyVariablesProductShortName">RDM</span> will use its default TFServer name ("localhost").</p></td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">REMOST_HOST<sup>[1]</sup></td>
                    <td class="BodyD-Column2-Body1">Name of the remote server.  If REMOTE_HOST is not specified, <span class="MyVariablesProductShortName">RDM</span> will use its default remote server name ("localhost").</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">DATABASE</td>
                    <td class="BodyA-Column2-Body1">Name of the database to open upon successful connection to the data source.</td>
                </tr>
            </tbody>
        </table>
        <p>For more information, reference MSDN&#160;documentation for <a href="http://msdn.microsoft.com/en-us/library/ms715433(v=VS.85).aspx" target="_blank">SQLDriverConnect.</a></p>
        <hr MadCap:conditions="Default.ScreenOnly" width="100%" size="0" align="center" />
        <p MadCap:conditions="Default.ScreenOnly" style="font-size: 8pt;"><span class="MyVariablesCopyright">Copyright © 2012, Raima Inc. All rights reserved.</span>
        </p>
        <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
        </script>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom" style="display: none;"><a href="../../../Default_CSH.htm#ODBCRM/api/SQLDriverConnect.htm" style="">Open topic with navigation</a>
        </p>
    </body>
</html>