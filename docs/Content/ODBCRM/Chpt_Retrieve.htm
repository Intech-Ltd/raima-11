<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:tocPath="SQL API|ODBC User's Guide" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" lang="en-us" xml:lang="en-us" MadCap:PathToHelpSystem="../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Retrieving the Result Set</title>
        <link rel="icon" type="image/png" href="http://docs.raima.com/favicon.png" />
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/raima.css" rel="stylesheet" />
        <script src="../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop" style="display: none;"><a href="../../Default_CSH.htm#ODBCRM/Chpt_Retrieve.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../dbRSQL.htm">SQL API</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="dbODBCUG.htm">ODBC User's Guide</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Retrieving the Result Set</span>
        </div>
        <h2 class="newpage"><a MadCap:generatedBookmark="TOC" name="Retrieving_the_Result_Set"></a>Retrieving the Result Set</h2>
        <p>SQL statements can return data from the data source. Those statements that do are called "queries." Queries can be executed in the same manner as the other SQL statements. However, an application must take additional steps to retrieve the data.</p>
        <p>The data an application retrieves from the data source comes in one or more rows that in turn include one or more columns. This set of data is called "result set."</p>
        <p>Retrieving the result set involves two steps.</p>
        <h3><a MadCap:generatedBookmark="TOC" name="Binding_Columns"></a>Binding Columns</h3>
        <p>First, an application should tell <span class="MyVariablesProductShortName">RDM</span> ODBC where it wants the result set to be stored. This step is called "binding columns." An application binds a column by specifying the pointer to a variable for each returned column through a call to <code>SQLBindCol</code>. An application can call <code>SQLBindCol</code> on each of the columns for which it needs to access the returned values.</p>
        <h3><a MadCap:generatedBookmark="TOC" name="Fetching_Columns"></a>Fetching Columns</h3>
        <p>After binding necessary columns, an application can call <code>SQLFetch</code> to retrieve the result set. <code>SQLFetch</code> retrieves the result set one row at a time by default. An application typically calls <code>SQLFetch</code> repeatedly until it returns <code>SQL_NO_DATA</code>, which indicates the end of the result set has been reached. Each call to <code>SQLFetch</code> puts the values of the current result row into the variables bound to the columns by <code>SQLBindCol</code>.</p>
        <p>The following example illustrates how to retrieve all the rows stored in the PERSON table of the NSFAWARDS table.</p>
        <p class="Caption">Example 7 Retrieving rows from PERSON</p><pre xml:space="preserve">#include "sqlrdm.h"

SQLRETURN runDbOperations(
    SQLHDBC hDbc)
{
    SQLRETURN   rc;
    SQLHSTMT    hStmt;
    const char *pszStmt = "SELECT * FROM person";
    char        szName[36];
    char        szGender[2];
    char        szJob[2];
    SQLLEN      cb1, cb2, cb;

    /* Allocate a statement handle */
    rc = SQLAllocHandle(SQL_HANDLE_STMT, hDbc, &amp;hStmt);
    if (SQL_SUCCEEDED(rc)) {
        /* Open the NSFAWARDS database first */
        rc = SQLExecDirect(hStmt, (SQLCHAR *) "OPEN nsfawards",
                SQL_NTS);
        if (SQL_SUCCEEDED(rc)) {
            /* Execute a SELECT statement */
            rc = SQLExecDirect(hStmt,
                (SQLCHAR *) pszStmt, SQL_NTS);
 
            if (SQL_SUCCEEDED(rc)) {
                /* Bind all the 3 columns */ 
                (void) SQLBindCol(hStmt 1, SQL_C_CHAR,
                        szName, sizeof(szName), &amp;cb1);
                (void) SQLBindCol(hStmt 2, SQL_C_CHAR,
                        szGender, sizeof(szGender), &amp;cb2);
                (void) SQLBindCol(hStmt 3, SQL_C_CHAR,
                        szJob, sizeof(szJob), &amp;cb3);

                do {
                    /* Fetch as many rows as there are */
                    rc = SQLFetch(hStmt);
                    if (SQL_SUCCEEDED(rc)) {
                        if (cb1 != SQL_NULL_DATA)
                             printf("Name = %s\n", szName);
                        if (cb2 != SQL_NULL_DATA)
                             printf("Gender = %s\n", szGender);
                        if (cb3 != SQL_NULL_DATA)
                             printf("Jobclass = %s\n", szJob);
                    }
                } while (SQL_SUCCEEDED(rc));

                /* This means fetch completed successfully */
                if (rc == SQL_NO_DATA)
                    rc = SQL_SUCCESS;
            }
        }
        (void) SQLFreeHandle(SQL_HANDLE_STMT, hStmt);
    }

    return rc;
}
</pre>
        <p>The last argument of <code>SQLBindCol</code> specifies the pointer to a variable where the ODBC drive will store the length of the returned column data. A value of <code>SQL_NULL_DATA</code> indicates that the returned column contains <code>NULL</code>.</p>
        <hr MadCap:conditions="Default.ScreenOnly" width="100%" size="0" align="center" />
        <p MadCap:conditions="Default.ScreenOnly" style="font-size: 8pt;"><span class="MyVariablesCopyright">Copyright Â© 2012, Raima Inc. All rights reserved.</span>
        </p>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom" style="display: none;"><a href="../../Default_CSH.htm#ODBCRM/Chpt_Retrieve.htm" style="">Open topic with navigation</a>
        </p>
    </body>
</html>