<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:tocPath="SQL API|SQL Language Guide|Reference Guide|SQL Statement Reference" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" lang="en-us" xml:lang="en-us" MadCap:PathToHelpSystem="../../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>lock table</title>
        <link rel="icon" type="image/png" href="http://docs.raima.com/favicon.png" />
        <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/raima.css" rel="stylesheet" />
        <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop" style="display: none;"><a href="../../../Default_CSH.htm#SQL/DML/locktable.htm" style="">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../../dbRSQL.htm">SQL API</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../dbSQL.htm">SQL Language Guide</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../SQLStmtRef.htm">Reference Guide</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">lock table</span>
        </div>
        <h3 class="newpage"><a name="kanchor239"></a>lock table</h3>
        <p>Explicitly lock one or more database tables</p>
        <p class="Heading">Syntax</p><pre class="Grammar" xml:space="preserve">lock_stmt:
 	<b>lock table</b> [<b>in</b>    <![CDATA[ ]]><i>db_name</i>]  table_lock[, table_lock]...</pre><pre class="Grammar" xml:space="preserve">table_lock:
		table_name [<b>read</b> | <b>write</b>&#160;|&#160;<b>default</b>]</pre>
        <p class="Heading">Description </p>
        <p>The <b>lock table</b> statement can be used to explicitly lock one or more tables contained in any of the databases currently open in the connection in which this statement is executed.  The <b>in</b> <![CDATA[ ]]><i>db_name</i> clause can be specified to identify the specific database that contains the listed tables in the event that more than one database is open that have duplicate table names.</p>
        <p>If neither <b>read</b> nor <b>write</b> is specified, then <b>read</b> is the default outside of a transaction and <b>write</b> is the default inside a transaction.  Either all lock requests will succeed or none will.  I.e.,  this is an either all or none request which can be used to prevent a deadlock situation in which one process holds a lock on table A while requesting a lock on table B while a second process is holding a lock on table B while requesting a lock on table A.</p>
        <p>Write lock requests issued when a transaction is not active will return an error.  If a read only transaction is active then the lock request will also return an error.</p>
        <p>The system will switch into <i>explicit locking</i> mode on execution of the first <b>lock table</b> statement.  In this mode, all tables that are accessed by any subsequent SQL statements must be explicitly locked.  If not, SQL will return an <code>errNOTLOCKED</code> status. Note that the values of foreign key columns are retrieved from the referenced row in the primary key table (<span class="MyVariablesRSQLName">RDM SQL</span> does not actually store them in the foreign key table).  Hence, <i>both</i> the foreign and primary key tables must be explicitly locked when accessing foreign key column values.  Once all explicitly lock tables have been freed, the system will switch back into <i>implicit locking</i> mode.</p>
        <p>Read-locked tables can be freed by the <b>unlock table</b> statement.  Write-locked tables can only be freed by a <b>commit</b> or <b>rollback</b>.   Execution of a <b>commit</b> or <b>rollback</b> statement outside a transaction can also be used to free all read-locked tables.</p>
        <p>Explicit locking allows you to issue a single grouped lock request at the beginning of a transaction that involves modifications to more than one table in order to ensure that the transaction will not cause a deadlock situation to arise.  With implicit locking, the lock requests are made by execution of each <b>insert</b>, <b>update</b>, and <b>delete</b> statement which can potentially create a deadlock situation.   Alternatively, you can use transactional stored procedures with implicit locking to achieve the same deadlock free guarantee.</p>
        <p class="Notes">NOTE:&#160;When using the Standalone TFS&#160;Configuration, lock requests are treated ignored as the database is opened exclusively</p>
        <p class="Heading">Example </p><pre xml:space="preserve">start trans;
<b>lock table acctmgr, patron;</b>
insert into patron values "RLM","Merilatt, Randy", ..., "KATE";
commit;</pre>
        <p class="Heading">See Also</p>
        <p><a href="unlocktable.htm">unlock table</a>
        </p>
        <p><a href="../DDL/createproc.htm">create procedure</a>
        </p>
        <hr MadCap:conditions="Default.ScreenOnly" width="100%" size="0" align="center" />
        <p MadCap:conditions="Default.ScreenOnly" style="font-size: 8pt;"><span class="MyVariablesCopyright">Copyright Â© 2012, Raima Inc. All rights reserved.</span>
        </p>
        <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
        </script>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom" style="display: none;"><a href="../../../Default_CSH.htm#SQL/DML/locktable.htm" style="">Open topic with navigation</a>
        </p>
    </body>
</html>